#include "luckymouse.h"

//        // lucky mouse part
//        converter c;
//        file fk("/home/u/malware/lucky_mouse/2020_04_ir/dc_2019_04/1B5ABBF26311EF668FC305831CE2C154");
//        file fe("/home/u/malware/lucky_mouse/2020_04_ir/dc_2019_04/8B90693E71890AD4B84CB8FD8E4F141F");

//        // get key from legit launcher
//        fk.set_offset(0x10FE3);
//        storage vk = fk.get_bytes(8); // E8 F9 2E 00
//
//        // decrypt first layer, two parts
//        fe.map_file();
//        auto ve_it = fe.get_mapped_it();
//        c.dexor(next(ve_it, 0x40C), 8, vk.begin(), 8); // 33 2D 1F C9
//        c.dexor(next(ve_it, 0xA49), 8, vk.begin(), 8); // 33 2D 1F C9
//        fe.dump_mapped_to_file("/home/u/malware/lucky_mouse/2020_04_ir/dc_2019_04/8B90693E71890AD4B84CB8FD8E4F141F.dec", 0, fe.get_size());
//
//        // decrypt second layer
//        {
//            storage vk2({0x0c, 0xc3, 0x42, 0x06});
////            auto t = c.storage_to_dword(vk2.begin());
////            cout << hex << t << endl;
////            c.dword_to_storage(t, vk2.begin());
////            print_storage_hex(vk2.begin(), vk2.end());
//
//            c.dexor_key_change(next(ve_it, 0xA66), 0x9A, vk2.begin(), 4); // F0 21 B7 21
//            fe.dump_mapped_to_file("/home/u/malware/lucky_mouse/2020_04_ir/dc_2019_04/8B90693E71890AD4B84CB8FD8E4F141F.dec.dec", 0, fe.get_size());
//        }